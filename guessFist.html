<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        /*body{overflow: hidden;}*/
        div{
            box-sizing: border-box;
        }
    </style>
    <script src="jquery-1.9.1.min.js"></script>
    <script src="guessFistStyle.js"></script>
    <script>
        window.onload=function(){
            var scoreNum=5;
            var randomNum=0;
            var roundNum=1;
            var preRandomNum=0;
            var preIndex=0;
            var give=0;
            var timeNum=0;
            var oldMine=0;
            var oldComputer=0;
            var time=5000;
            var timer=null;
            var arr=[1,2,3];
            var arr1=[0,1,2];
            var aa=true;
            var documentWidth=document.documentElement.clientWidth||document.body.clientWidth;
            var documentHeight=document.documentElement.clientHeight||document.body.clientHeight;
            var fists=$("#selectFist div").eq(0).nextAll("div");
            var myViewImg=$("#myView div").eq(1).children("img");
            var computerViewImg=$("#computerView div").eq(1).children("img");

            function computerRandom(index){ //电脑随机出招 函数
                if(aa){
                    randomNum=Math.floor(Math.random()*3);
                    computerViewImg.attr("src","images/"+arr[randomNum]+".png");
                    increaseAnddecrease(index,randomNum);
                    oldComputer=randomNum;
                    oldMine=index;
                    console.log("index："+index);
                    console.log("randomNum："+randomNum);
                    $("#score").html("score:"+scoreNum+"");
                    $("#round").html("round:"+roundNum+"");
                    aa=false;
                }else{
                    if(oldMine==oldComputer){
                        if(oldComputer==0){oldComputer=3};
                        give=oldComputer-1;
                        console.log(give);
                        console.log(arr[give]);
                        computerViewImg.attr("src","images/"+arr[give]+".png");  //不理解的一步：arr[give]是underfined，但又不报错。但如果give=!oldComputer;不写又不行
                        oldMine=index;
                        oldComputer=give;
                    }
                    if(oldMine!=oldComputer){
                        function clearArr(arr1){
                            return arr1!=oldMine&&arr1!=oldComputer;
                        }
                        give=arr1.filter(clearArr)[0];
                        computerViewImg.attr("src","images/"+arr[give]+".png");
                        console.log(index);
                        console.log(arr[give]);
                        increaseAnddecrease(index,give);
                        oldMine=index;
                        oldComputer=give;
                        $("#score").html("score:"+scoreNum+"");
                        $("#round").html("round:"+roundNum+"");
                    }
                }
            }
            function increaseAnddecrease(mine,computer){
                if((mine==0&&computer==2)||(mine==1&&computer==0)||(mine==2&&computer==1)){
                    scoreNum++;
                }else if((mine==2&&computer==0)||(mine==0&&computer==1)||(mine==1&&computer==2)){
                    scoreNum--;
                }
            }
            if(documentWidth>documentHeight){ //横屏状态

                //调用样式
                horizontal(documentWidth,documentHeight);
                //点击出拳

                fn();
                function fn(){
                    fists.each(function(index){
                        clearInterval(timer);
                        fists.eq(index).on("click",function(){
                            myViewImg.attr("src",$(this).children("img").attr("src"));
                            computerRandom(index);
                            clearInterval(timer);
                            fn();
                        });
                    });
                    timer=setInterval(function(){
                        fists.each(function(index){
                            fists.eq(index).on("click",function(){
                                clearInterval(timer);
                                fn();
                            });
                        });
                        scoreNum--;
                        if(scoreNum<0){alert("game over")}
                        $("#score").html("score:"+scoreNum+"");
                        $("#round").html("round:"+roundNum+"");
                    },time)
                }
            }
            if(documentWidth<documentHeight){ //竖屏状态
                vertical(documentWidth,documentHeight);
                fn();
                function fn(){
                    fists.each(function(index){
                        clearInterval(timer);
                        fists.eq(index).on("click",function(){
                            myViewImg.attr("src",$(this).children("img").attr("src"));
                            computerRandom(index);
                            clearInterval(timer);
                            fn();
                        });
                    });
                    timer=setInterval(function(){
                        fists.each(function(index){
                            fists.eq(index).on("click",function(){
                                clearInterval(timer);
                                fn();
                            });
                        });
                        scoreNum--;
                        if(scoreNum<0){alert("game over")}
                        $("#score").html("score:"+scoreNum+"");
                        $("#round").html("round:"+roundNum+"");
                    },time)
                }
            }


        }
    </script>
</head>
<body>
<div id="main">
    <p>游戏规则：xxxxxxxxxxxxxxxxxxxxxx</p>
    <div id="score">score:5</div>
    <div id="round">round:1</div>
    <div id="selectFist">
        <div>请出拳</div>
        <div><img src="images/1.png"></div>
        <div><img src="images/2.png"></div>
        <div><img src="images/3.png"></div>
    </div>
    <div id="box">

        <div id="myView"><div>我方出拳</div><div><img src="images/1.gif"></div></div>
        <div id="vs"><img src="images/2.gif"></div>
        <div id="computerView"><div>电脑出拳</div><div><img src="images/1.gif"></div></div>
    </div>
</div>
</body>
</html>